<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detector de Movimiento de los Ojos</title>
  <script src="https://webgazer.cs.brown.edu/webgazer.js"></script>

  <script src="https://webgazer.cs.brown.edu/webgazer.js"></script>

  <script>
      window.onload = function () {
        const startBtn = document.getElementById("startBtn");
        const calibrationProgress = document.getElementById("calibrationProgress");
        const pointDiv = document.getElementById("pointDiv");
        const recordTime = document.getElementById("recordTime");
        const exitBtn = document.getElementById("exitBtn");

        let isCalibrated = false;
        let timer = null;
        let currentTime = 0;
        let maxTime = 0;

        startBtn.addEventListener("click", function () {
          if (!isCalibrated) {
            webgazer
              .setGazeListener(function (data, elapsedTime) {
                if (!isCalibrated) {
                  if (elapsedTime < 3000) {
                    calibrationProgress.innerHTML = "Calibración: 1/3";
                  } else if (elapsedTime < 6000) {
                    calibrationProgress.innerHTML = "Calibración: 2/3";
                  } else if (elapsedTime < 9000) {
                    calibrationProgress.innerHTML = "Calibración: 3/3";
                  } else {
                    isCalibrated = true;
                    calibrationProgress.innerHTML = "Calibración completada!";
                    pointDiv.style.display = "block";
                  }
                }
              })
              .begin();
          }
        });

        window.setInterval(function () {
          if (isCalibrated && webgazer.isReady()) {
            const prediction = webgazer.getCurrentPrediction();
            if (prediction) {
              const x = prediction.x;
              const y = prediction.y;
              const maxX = window.innerWidth;
              const maxY = window.innerHeight;
              pointDiv.style.top = `${y * maxY}px`;
              pointDiv.style.left = `${x * maxX}px`;

              if (x > 0.45 && x < 0.55 && y > 0.45 && y < 0.55) {
                if (timer === null) {
                  timer = window.setInterval(function () {
                    currentTime++;
                    recordTime.innerHTML = `Record: ${maxTime}s`;
                    if (currentTime > maxTime) {
                      maxTime = currentTime;
                    }
                  }, 1000);
                }
              } else {
                if (timer !== null) {
                  clearInterval(timer);
                  timer = null;
                  currentTime = 0;
                }
              }
            }
          }
        }, 100);

        exitBtn.addEventListener("click", function () {
          window.location.href = "TU LINK AQUÍ";
        });
      };
    </script>


  <style>
    
     .container {
        max-width: 800px;
        margin: 0 auto;
        font-size: 16px;
      }

      #startBtn, #stopBtn {
        padding: 10px;
        background-color: #007bff;
        color: #fff;
        border-radius: 5px;
        border: none;
        cursor: pointer;
      }

      #startBtn:hover, #stopBtn:hover {
        background-color: #0069d9;
      }

      #statusText {
        margin-top: 20px;
        font-size: 18px;
      }

      #counterText {
        margin-top: 20px;
        font-size: 24px;
        color: red;
      }

      #recordText {
        margin-top: 20px;
        font-size: 18px;
      }

      #exitBtn {
        margin-top: 40px;
        padding: 10px;
        background-color: #dc3545;
        color: #fff;
        border-radius: 5px;
        border: none;
        cursor: pointer;
      }

      #exitBtn:hover {
        background-color: #c82333;
      }
    
  </style>
</head>


<body>
  <div class="container">
    <h1>Detector de Movimiento de los Ojos</h1>
    <p>Semilleros de Investigación - Corporación Universitaria UNITEC</p>
    <p>Esta aplicación usa la libreria WebGazer.js como modelo de Inteligencia Artificial.</p>
    <p>Haga clic en el botón a continuación para iniciar la calibración:</p>
      <button id="startBtn">Iniciar Calibración</button>
      <p id="statusText"></p>
      <p id="counterText"></p>
      <p id="recordText"></p>
      <button id="stopBtn" style="display:none;">Detener</button>
      <button id="exitBtn">Salir de la sesión</button>

    <button id="exitBtn">Salir de la sesión</button>
</body>

</html>
